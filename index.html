<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ЁЯТа рд▓реЛрди рдХреИрд▓рдХреБрд▓реЗрдЯрд░ тАФ Nimmalwar Tulsiram (Days Interest)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#f0f7ff; --bg2:#fff7f3;
    --card:#ffffff; --primary:#0b6cff; --accent:#ff6b3d; --muted:#52606d;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:'Poppins',sans-serif;
    background: linear-gradient(135deg,var(--bg1),var(--bg2));
    color:#0f1724; padding:18px;
  }

  .wrap{max-width:900px;margin:10px auto}
  header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px}
  header h1{margin:0;font-size:20px}
  header .by{font-size:13px;color:var(--muted)}

  .grid{display:grid;grid-template-columns:1fr 360px;gap:14px}
  @media(max-width:920px){.grid{grid-template-columns:1fr}}

  .card{background:var(--card);border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(8,16,30,0.06)}
  label{display:block;font-size:13px;color:var(--muted);margin-top:10px}
  input[type=number], input[type=date], select{width:100%;padding:10px;border-radius:10px;border:1px solid #e6eef8;font-size:15px}
  .seg{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
  .modeBtn{padding:8px 12px;border-radius:10px;border:1px solid #e6eef8;background:#fff;cursor:pointer;font-weight:600}
  .modeBtn.active{background:linear-gradient(90deg,var(--primary),#3b8fff);color:#fff;border:0}

  .row{display:flex;gap:8px}
  .btnPrimary{flex:1;background:linear-gradient(90deg,var(--primary),#3b8ff0);color:#fff;border:0;padding:12px;border-radius:10px;font-weight:700;cursor:pointer}
  .btnGhost{background:transparent;border:1px solid #e6eef8;padding:10px;border-radius:10px;cursor:pointer;color:var(--muted)}
  .small{font-size:13px;color:var(--muted)}
  .result{margin-top:12px;padding:14px;border-radius:12px;background:linear-gradient(90deg,#fff,#fbfeff);border-left:5px solid var(--accent)}
  table{width:100%;border-collapse:collapse;margin-top:6px}
  th,td{padding:8px;text-align:left;border-bottom:1px solid #f1f5f9;font-size:14px}
  .emoji{font-size:18px;margin-right:6px}
  footer{margin-top:16px;text-align:center;color:var(--muted);font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>ЁЯТа рдЖрдХрд░реНрд╖рдХ рд▓реЛрди рдХреИрд▓рдХреБрд▓реЗрдЯрд░</h1>
        <div class="small">рд╕рд╣рдЬ тАв рд╣рд┐рдВрджреА тАв тВ╣ рдкреНрд░рддрд┐ 100 рдкреНрд░рддрд┐ рдорд╛рд╣ тАв Days interest included</div>
      </div>
      <div class="by">Designed тАФ <strong>Nimmalwar Tulsiram</strong></div>
    </header>

    <div class="grid">
      <!-- LEFT -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">рдХреИрд▓рдХреБрд▓реЗрдЯрд░</div>
          <div class="small">Flat-rate (тВ╣/100/month)</div>
        </div>

        <label>ЁЯТ░ рд▓реЛрди рд░рд╛рд╢рд┐ (тВ╣)</label>
        <input id="principal" type="number" placeholder="рдЙрджрд╛. 100000">

        <label>ЁЯФЦ рдмреНрдпрд╛рдЬ (тВ╣ рдкреНрд░рддрд┐ тВ╣100 рдкреНрд░рддрд┐ рдорд╛рд╣)</label>
        <input id="ratePer100" type="number" step="0.01" placeholder="рдЙрджрд╛. 2">

        <label>ЁЯЫая╕П рд╡рд┐рдХрд▓реНрдк рдЪреБрдиреЗрдВ</label>
        <div class="seg">
          <button id="btnDate" class="modeBtn active">ЁЯУЕ рддрд╛рд░реАрдЦрд╝ рд╕реЗ</button>
          <button id="btnManual" class="modeBtn">тЬНя╕П Manual Months/Days</button>
          <button id="btnFillToday" class="modeBtn">ЁЯУМ Start = рдЖрдЬ</button>
          <button id="btnFillCalcToday" class="modeBtn">ЁЯУМ Calc = рдЖрдЬ</button>
        </div>

        <!-- Date section -->
        <div id="dateSection" style="margin-top:12px">
          <label>ЁЯФ╣ рдкреИрд╕реЗ рджрд┐рдП рдЬрд╛рдиреЗ рдХреА рддрд╛рд░реАрдЦ (Start)</label>
          <input id="startDate" type="date">

          <label>ЁЯФ╣ рдЧрдгрдирд╛ рдХреА рддрд╛рд░реАрдЦ (Calc) тАФ рдЦрд╛рд▓реА рд░рдЦреЗрдВ = рдЖрдЬ</label>
          <input id="calcDate" type="date">
        </div>

        <!-- Manual section -->
        <div id="manualSection" style="display:none;margin-top:12px">
          <label>ЁЯУЖ рдХреБрд▓ рдорд╣реАрдиреЗ (Months)</label>
          <input id="manualMonths" type="number" min="0" placeholder="рдЙрджрд╛. 7">

          <label>ЁЯУЕ рдЕрддрд┐рд░рд┐рдХреНрдд рджрд┐рди (Days)</label>
          <input id="manualDays" type="number" min="0" placeholder="рдЙрджрд╛. 15">
          <div class="small">рдпрджрд┐ рдЖрдк рдорд╣реАрдиреЛрдВ/рджрд┐рдиреЛрдВ рдХреЛ рд╕реАрдзреЗ рджрд░реНрдЬ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВ</div>
        </div>

        <label style="margin-top:12px">ЁЯз╛ Days рдирд┐рдпрдо</label>
        <div class="small">рдЕрдм рджрд┐рди рднреА рдмреНрдпрд╛рдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗ тАФ <strong>days / 30</strong> рдХрд░рдХреЗ рдорд╛рд╣ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛рдПрдЧрд╛ (рдЙрджрд╛. 15 рджрд┐рди = 0.5 рдорд╛рд╣, 1 рджрд┐рди тЙИ 0.0333 рдорд╛рд╣)ред</div>

        <div class="row" style="margin-top:12px">
          <button id="calculateBtn" class="btnPrimary">ЁЯФв рдЧрдгрдирд╛ рдХрд░реЗрдВ</button>
          <button id="resetBtn" class="btnGhost">тЩ╗я╕П рд░реАрд╕реЗрдЯ</button>
        </div>

        <div id="output" class="result" style="display:none"></div>
      </div>

      <!-- RIGHT -->
      <div>
        <div class="card">
          <div style="font-weight:700">рдирддреАрдЬреЗ (Result)</div>
          <div class="small" style="margin-top:6px">рдпрд╣рд╛рдБ рдкрд░ рдЖрдкрдХреЗ calculations emojis рдХреЗ рд╕рд╛рде рд╕рд╛рдл рджрд┐рдЦреЗрдВрдЧреЗ тАФ рд╕рдордп, effective months, рдмреНрдпрд╛рдЬ рдФрд░ рдХреБрд▓ рд╡рд╛рдкрд╕реАред</div>

          <div style="margin-top:10px; display:flex; gap:8px;">
            <button id="saveBtn" class="btnGhost">ЁЯТ╛ Save</button>
            <button id="loadBtn" class="btnGhost">ЁЯУВ Load</button>
            <button id="exportBtn" class="btnGhost">ЁЯЦия╕П Print</button>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="card">
          <div style="font-weight:700">Help</div>
          <div class="small" style="margin-top:8px">
            тАв Start date рдбрд╛рд▓реЗрдВ рдпрд╛ Start = рдЖрдЬ рдмрдЯрди рд╕реЗ рднрд░ рджреЗрдВред<br>
            тАв Calc date рдЦрд╛рд▓реА рдЫреЛрдбрд╝реЗрдВрдЧреЗ рддреЛ рдЖрдЬ рд╕реЗ рдХреИрд▓рдХреБрд▓реЗрдЯ рд╣реЛрдЧрд╛ред<br>
            тАв Manual mode рдореЗрдВ months/days рд╕реАрдзреЗ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред<br>
            тАв Days рдХрд╛ рдЗрдВрдЯрд░реЗрд╕реНрдЯ now proportional рд╣реИ (days/30).
          </div>
        </div>
      </div>
    </div>

    <footer>┬й Nimmalwar Tulsiram</footer>
  </div>

<script>
  // shortcuts
  const $ = id => document.getElementById(id);
  const fmtINR = v => Number(v).toLocaleString('en-IN', {minimumFractionDigits:2, maximumFractionDigits:2});

  // elements
  const btnDate = $('btnDate'), btnManual = $('btnManual'), btnFillToday = $('btnFillToday'), btnFillCalcToday = $('btnFillCalcToday');
  const dateSection = $('dateSection'), manualSection = $('manualSection');
  const calculateBtn = $('calculateBtn'), resetBtn = $('resetBtn');
  const output = $('output');
  const saveBtn = $('saveBtn'), loadBtn = $('loadBtn'), exportBtn = $('exportBtn');

  // mode toggles
  btnDate.addEventListener('click', ()=>{ setMode('date'); });
  btnManual.addEventListener('click', ()=>{ setMode('manual'); });
  btnFillToday.addEventListener('click', ()=>{ $('startDate').value = new Date().toISOString().slice(0,10); });
  btnFillCalcToday.addEventListener('click', ()=>{ $('calcDate').value = new Date().toISOString().slice(0,10); });

  function setMode(mode){
    if(mode==='date'){
      btnDate.classList.add('active'); btnManual.classList.remove('active');
      dateSection.style.display='block'; manualSection.style.display='none';
    } else {
      btnManual.classList.add('active'); btnDate.classList.remove('active');
      manualSection.style.display='block'; dateSection.style.display='none';
    }
  }

  resetBtn.addEventListener('click', ()=>{
    $('principal').value=''; $('ratePer100').value=''; $('startDate').value=''; $('calcDate').value='';
    $('manualMonths').value=''; $('manualDays').value=''; output.style.display='none';
  });

  // main calculate
  calculateBtn.addEventListener('click', ()=>{
    const principal = parseFloat($('principal').value);
    const ratePer100 = parseFloat($('ratePer100').value);

    if (isNaN(principal) || principal <= 0) { alert('рдХреГрдкрдпрд╛ рд▓реЛрди рд░рд╛рд╢рд┐ рд╕рд╣реА рдбрд╛рд▓реЗрдВ'); return; }
    if (isNaN(ratePer100) || ratePer100 < 0) { alert('рдХреГрдкрдпрд╛ рдмреНрдпрд╛рдЬ (тВ╣ рдкреНрд░рддрд┐ тВ╣100 рдкреНрд░рддрд┐ рдорд╛рд╣) рд╕рд╣реА рдбрд╛рд▓реЗрдВ'); return; }

    let years=0, months=0, days=0, effectiveMonths=0;

    if (btnDate.classList.contains('active')) {
      const sVal = $('startDate').value;
      if (!sVal) { alert('рдХреГрдкрдпрд╛ рдкреИрд╕реЗ рджреЗрдиреЗ рдХреА рддрд╛рд░реАрдЦ рднрд░реЗрдВ'); return; }
      const start = new Date(sVal);
      const eVal = $('calcDate').value;
      const end = eVal ? new Date(eVal) : new Date();

      if (end < start) { alert('рдХреИрд▓рдХреБрд▓реЗрд╢рди рддрд╛рд░реАрдЦ start рддрд╛рд░реАрдЦ рд╕реЗ рдкрд╣рд▓реЗ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА'); return; }

      // compute Y M D precisely
      years = end.getFullYear() - start.getFullYear();
      months = end.getMonth() - start.getMonth();
      days = end.getDate() - start.getDate();

      if (days < 0) {
        months--;
        const prevMonthDays = new Date(end.getFullYear(), end.getMonth(), 0).getDate();
        days += prevMonthDays;
      }
      if (months < 0) {
        years--;
        months += 12;
      }

      // NEW: include days proportionally: days/30
      effectiveMonths = years*12 + months + (days / 30);

    } else {
      // manual
      const m = parseInt($('manualMonths').value) || 0;
      const d = parseInt($('manualDays').value) || 0;
      if (m < 0 || d < 0) { alert('рдорд╣реАрдиреЗ/рджрд┐рди рд╕рд╣реА рдбрд╛рд▓реЗрдВ'); return; }
      years = Math.floor(m / 12);
      months = m % 12;
      days = d;
      // NEW: include days proportionally: days/30
      effectiveMonths = m + (d / 30);
    }

    // calculations (flat-rate in тВ╣ per 100 per month)
    // interest = (principal / 100) * ratePer100 * effectiveMonths
    const totalInterest = (principal / 100) * ratePer100 * effectiveMonths;
    const totalPayable = principal + totalInterest;
    const approxPerMonth = effectiveMonths > 0 ? (totalPayable / effectiveMonths) : 0;

    // show results with emojis
    output.style.display='block';
    output.innerHTML = `
      <div style="font-weight:700;margin-bottom:8px">ЁЯУК рдкрд░рд┐рдгрд╛рдо</div>
      <table>
        <tr><td>тП│ рдмреАрддрд╛ рд╕рдордп</td><td>${years} рд╕рд╛рд▓, ${months} рдорд╣реАрдиреЗ, ${days} рджрд┐рди</td></tr>
        <tr><td>ЁЯз╛ Days рджрд┐рдЦрд╛</td><td>${days} рджрд┐рди</td></tr>
        <tr><td>ЁЯФв Effective months</td><td>${Number(effectiveMonths.toFixed(4))} рдорд╛рд╣</td></tr>
        <tr><td>ЁЯТ╕ рдХреБрд▓ рдмреНрдпрд╛рдЬ</td><td>тВ╣ ${fmtINR(totalInterest)}</td></tr>
        <tr><td>ЁЯТ░ рдХреБрд▓ рджреЗрдп (Principal + Interest)</td><td>тВ╣ ${fmtINR(totalPayable)}</td></tr>
        <tr><td>ЁЯУЕ рдЕрдиреБрдорд╛рдирд┐рдд рдкреНрд░рддрд┐ рдорд╛рд╣</td><td>${effectiveMonths>0 ? 'тВ╣ '+fmtINR(approxPerMonth)+' (approx)' : 'тАФ'}</td></tr>
      </table>
      <div class="small" style="margin-top:8px">рдиреЛрдЯ: Days рдХрд╛ рдмреНрдпрд╛рдЬ proportional рд╣реИ (days/30)ред</div>
    `;

    // enable save
    lastResult = {
      principal, ratePer100, years, months, days, effectiveMonths, totalInterest, totalPayable
    };
  });

  // Save / Load using localStorage (simple)
  let lastResult = null;
  saveBtn.addEventListener('click', ()=>{
    try {
      const state = {
        principal: $('principal').value, ratePer100: $('ratePer100').value,
        startDate: $('startDate').value, calcDate: $('calcDate').value,
        manualMonths: $('manualMonths').value, manualDays: $('manualDays').value
      };
      localStorage.setItem('loan_calc_state_v1', JSON.stringify(state));
      alert('Saved тЬЕ');
    } catch(e){ alert('Save failed'); }
  });
  loadBtn.addEventListener('click', ()=>{
    try {
      const s = localStorage.getItem('loan_calc_state_v1');
      if(!s) return alert('No saved data');
      const st = JSON.parse(s);
      $('principal').value = st.principal || '';
      $('ratePer100').value = st.ratePer100 || '';
      $('startDate').value = st.startDate || '';
      $('calcDate').value = st.calcDate || '';
      $('manualMonths').value = st.manualMonths || '';
      $('manualDays').value = st.manualDays || '';
      alert('Loaded тЬЕ');
    } catch(e){ alert('Load failed'); }
  });

  // print/export simple
  exportBtn.addEventListener('click', ()=>{
    if(output.style.display === 'none') return alert('рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рдЧрдгрдирд╛ рдХрд░реЗрдВ');
    const w = window.open('', '_blank');
    w.document.write('<pre style="font-family:Arial, sans-serif; font-size:14px;">' + output.innerText + '</pre>');
    w.document.close();
    w.print();
  });

</script>
</body>
</html>
